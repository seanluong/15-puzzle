!function(a,b){b["true"]=a;var c=function(a){a?(this.cells=a.cells,this.row=a.row,this.col=a.col,this.target=a.target,this.locked=a.locked):(this.cells=[[1,2,3,4],[5,6,7,8],[9,10,11,12],[13,14,15,0]],this.row=3,this.col=3,this.target=[[1,2,3,4],[5,6,7,8],[9,10,11,12],[13,14,15,0]],this.locked=!1,this.shuffle())};c.prototype.getValue=function(a){var b=this.row+a.drow,c=this.col+a.dcol;return b>=0&&3>=b&&c>=0&&3>=c?this.cells[b][c]:null},c.prototype.shuffle=function(a){for(var b,c=a||100,d=[0,0,-1,1],e=[1,-1,0,0];c>0;)b=parseInt(4*Math.random()),this.slide({drow:d[b],dcol:e[b]}),c--},c.prototype.slide=function(a){var b,c=this.row+a.drow,d=this.col+a.dcol;return c>=0&&3>=c&&d>=0&&3>=d&&(b=this.cells[this.row][this.col],this.cells[this.row][this.col]=this.cells[c][d],this.cells[c][d]=b,this.row=c,this.col=d),this},c.prototype.won=function(){var a,b;for(a in this.cells)for(b in this.cells[a])if(this.cells[a][b]!==this.target[a][b])return!1;return!0};{var d=["$scope","keyboardMapService",function(a,b){a.handleKeyDown=function(c){var d,e=c.altKey||c.ctrlKey||c.metaKey||c.shiftKey,f=b(c.which),g=75;return!e&&f&&(c.preventDefault(),d={direction:f,duration:g},a.$broadcast("keydown",d)),d}}],e=["$scope","localStorageService",function(a,b){a.timePassed=b.getTimePassed(),a.bestTime=b.getBestTime(),a.stopClock=!1,a.$on("new-game",function(){a.timePassed=0,a.bestTime=b.getBestTime(),a.stopClock=!1}),a.$on("game-won",function(){b.updateBestTime(a.timePassed),b.setTimePassed(0),a.stopClock=!0}),a.newGame=function(){a.$parent.$broadcast("new-game")}}],f=["$scope","localStorageService","directionService",function(a,b,d){function e(e,f){if(!a.board.locked){var g=d.getReverse(e),h=d.getDelta(e),i=d.getDelta(g),j=a.board.getValue(i);j&&(a.board.slide(i),a.move={duration:f,movedTiledValue:j,drow:h.drow,dcol:h.dcol},a.board.won()===!0?(b.setBoard(new c),a.$parent.$broadcast("game-won"),a.$broadcast("pause")):b.setBoard(a.board))}}a.board=b.getBoard(),a.series=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15],a.init=!0,a.move={},a.swipe=function(a){a.preventDefault(),e(a.gesture.direction,50)},a.$on("new-game",function(){a.board=new c,b.setBoard(a.board),a.init=!a.init}),a.$on("keydown",function(a,b){e(b.direction,b.duration)}),a.$on("pause",function(){a.board.locked=!0}),a.$on("resume",function(){a.board.locked=!1})}],g=["$scope",function(a){a.show=!1,a.$on("new-game",function(){a.show=!1}),a.$on("game-won",function(){a.show=!0})}],h=["$interval","localStorageService",function(a,b){function c(c,d,e){var f,g=1;d.on("$destroy",function(){a.cancel(f)}),f=a(function(){c.timePassed+=g,g>0&&b.setTimePassed(c.timePassed)},1e3),c.$watch(e.stop,function(a){console.log(a),g=a?0:1})}return{restrict:"A",link:c,template:"{{timePassed | duration}}"}}],i=[function(){return{restrict:"A",link:function(a,b,c){a.$watch(c.ngMyFade,function(a,c){a===!0?b.fadeIn():c?b.fadeOut():b.hide()})}}}],j=function(){function a(a,b,c){function d(a,b,c){var d,e,f=[0,1,2,3];for(d in f)for(e in f)if(a[d][e]===b)return{y:d*c,x:e*c}}function e(){var c=parseInt(b.text())||0,e=d(a.board.cells,c,g),f=e.y,h=e.x;b.css({left:h+"rem",top:f+"rem"}),0!==c&&(b.attr({"class":"tile my-tile"}),b.text(c))}function f(c){var e,f,h,i=parseInt(b.text())||0;c.movedTiledValue&&c.movedTiledValue===i&&(h=d(a.board.cells,0,g),e=c.drow*g+h.y,f=c.dcol*g+h.x,b.animate({left:f+"rem",top:e+"rem"},c.duration))}var g=12;a.$watch(c.init,function(){e()}),a.$watch(c.move,function(a){f(a)})}return{link:a}},k=[function(){return{getDelta:function(a){var b={};return"up"===a?(b.drow=-1,b.dcol=0):"down"===a?(b.drow=1,b.dcol=0):"left"===a?(b.drow=0,b.dcol=-1):"right"===a?(b.drow=0,b.dcol=1):b=null,b},getReverse:function(a){return"up"===a?"down":"down"===a?"up":"left"===a?"right":"right"===a?"left":null}}}],l=[function(){var a={38:"up",40:"down",37:"left",39:"right",87:"down",65:"right",83:"up",68:"left"};return function(b){return a[b]}}],m=[function(){var a=function(){return parseInt(localStorage.getItem("bestTime"))||null},b=function(a){localStorage.setItem("bestTime",a)},d=function(a){localStorage.setItem("timePassed",a)};return{getBestTime:a,setBestTime:b,setTimePassed:d,getBoard:function(){return new c(JSON.parse(localStorage.getItem("board")))},setBoard:function(a){return localStorage.setItem("board",JSON.stringify(a))},getTimePassed:function(){return parseInt(localStorage.getItem("timePassed"))||0},updateBestTime:function(c){var d=a();(!d||d>c)&&b(c)}}}],n=[function(){function a(a){return a>9?a:a>=0?"0"+a:"--"}function b(b){var c,d,e;return c=b,e=Math.floor(c/3600),c%=3600,d=Math.floor(c/60),c%=60,a(e)+":"+a(d)+":"+a(c)}return function(a){return a=a||"",0===a.length?"--:--:--":b(parseInt(a))}}];angular.module("animation",[]).directive("ngMyFade",i),angular.module("directives",[]).directive("ngTile",j).directive("ngClock",h),angular.module("keyboardInput",[]).factory("keyboardMapService",l).controller("bodyController",d),angular.module("main",["services","directives"]).controller("headerController",e).controller("mainController",f),angular.module("services",[]).factory("localStorageService",m).factory("directionService",k),angular.module("timeFormat",[]).filter("duration",n),angular.module("wonMessage",["animation"]).controller("wonMessageController",g),angular.module("myApp",["angular-gestures","ngSocial","timeFormat","keyboardInput","wonMessage","main"]).run(function(){$(function(){$("#board-container").on("touchmove",function(a){a.preventDefault()})})})}}({},function(){return this}());